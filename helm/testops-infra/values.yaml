# Default values for testops-infra

global:
  namespace: team9-ns

  # Global image settings
  image:
    pullPolicy: Always
    registry: docker.io

  # PostgreSQL Database
  postgres:
    enabled: false
    # Using external database - password from secret
    external:
      host: 79.174.89.43
      port: 18809
      database: team9_db
      username: team9
      # passwordSecretRef: team9-db-secret (to be created separately)

  # Kafka - disabled, using Strimzi instead
  kafka:
    enabled: false

  # Strimzi Kafka Cluster (KRaft Mode - no ZooKeeper)
  strimzi:
    kafka:
      enabled: true
      name: team9-kafka
      version: "4.1.1"
      metadataVersion: "4.1-IV1"
      brokers:
        replicas: 2
        resources:
          requests:
            memory: 512Mi
            cpu: 250m
          limits:
            memory: 1Gi
            cpu: 500m
      controller:
        replicas: 1
        resources:
          requests:
            memory: 256Mi
            cpu: 100m
          limits:
            memory: 512Mi
            cpu: 200m
      topicOperator:
        resources:
          requests:
            memory: 256Mi
            cpu: 100m
          limits:
            memory: 512Mi
            cpu: 200m
      userOperator:
        resources:
          requests:
            memory: 256Mi
            cpu: 100m
          limits:
            memory: 512Mi
            cpu: 200m
      storage:
        type: persistent-claim
        size: 10Gi
        controllerSize: 5Gi
      minInSyncReplicas: 1

  # Django App reference (for configmap/secrets)
  djangoApp:
    name: team9-publisher

  # Security
  rbac:
    enabled: true

  # Secrets - all moved to Vault via ExternalSecrets
  # Create in Vault:
  # - kv/team9/postgres: password
  # - kv/team9/django: secret_key
  # - kv/team9/api-keys: gemini_api_key, google_oauth2_key, google_oauth2_secret, grafana_cloud_api_key
  secrets:
    enabled: true

  # Monitoring
  monitoring:
    prometheus:
      enabled: true
      image:
        repository: prom/prometheus
        tag: "v2.48.0"
      resources:
        requests:
          memory: "128Mi"
          cpu: "100m"
        limits:
          memory: "256Mi"
          cpu: "200m"
    grafana:
      username: "2849703"
      prometheusUrl: https://prometheus-prod-43-prod-ap-south-1.grafana.net/api/prom/push

  # Kafka UI for monitoring and management
  kafkaUi:
    enabled: true

  # Ingress (needed for configmap)
  ingress:
    hosts:
      - host: testops.thduc.tech

# Subchart conditions
postgres:
  enabled: true

kafka:
  enabled: true

prometheus:
  enabled: true
